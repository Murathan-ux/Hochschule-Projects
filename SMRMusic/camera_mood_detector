import cv2
import fer

def get_camera_mood():
    emotion_map = {
        "happy": "happy",
        "sad": "sad",
        "angry": "angry",
        "disgust": "angry",
        "fear": "anxious",
        "surprise": "calm",
        "neutral": "neutral"
    }

    detector = fer.FER(mtcnn=True)
    cap = cv2.VideoCapture(0)
    detected_mood = "neutral"

    while True:
        ret, frame = cap.read()
        if not ret:
            break

        emotions = detector.detect_emotions(frame)
        if emotions:
            top_emotion = detector.top_emotion(frame)
            if top_emotion:
                emotion, _ = top_emotion
                detected_mood = emotion_map.get(emotion, "neutral")
                break

        if cv2.waitKey(1) & 0xFF == ord('q'):
            break

    cap.release()
    cv2.destroyAllWindows()
    return detected_mood
